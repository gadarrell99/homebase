<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ¤–</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agents | Homebase</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0f172a; color: #e2e8f0; min-height: 100vh; }
a { color: #60a5fa; text-decoration: none; }
.main-nav { display: flex; align-items: center; padding: 0.75rem 1.5rem; background: #1e293b; border-bottom: 1px solid #334155; position: sticky; top: 0; z-index: 100; }
.main-nav .logo { font-size: 1.1rem; font-weight: 600; color: #e2e8f0; margin-right: 2rem; text-decoration: none; }
.main-nav .nav-links { display: flex; gap: 0.25rem; flex: 1; flex-wrap: wrap; }
.main-nav .nav-links a { color: #94a3b8; padding: 0.5rem 0.75rem; border-radius: 0.375rem; font-size: 0.875rem; text-decoration: none; transition: all 0.15s; }
.main-nav .nav-links a:hover, .main-nav .nav-links a.active { color: #e2e8f0; background: #334155; }
.page-container { padding: 1.5rem; max-width: 1200px; margin: 0 auto; }
.page-header { margin-bottom: 1.5rem; }
.page-header h1 { font-size: 1.75rem; font-weight: 600; margin-bottom: 0.25rem; }
.page-header p { color: #64748b; font-size: 0.875rem; }
.summary-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
.summary-card { background: #1e293b; border: 1px solid #334155; border-radius: 0.5rem; padding: 1rem; text-align: center; }
.summary-card .num { font-size: 2rem; font-weight: 700; }
.summary-card .num.green { color: #4ade80; }
.summary-card .num.yellow { color: #fbbf24; }
.summary-card .num.blue { color: #60a5fa; }
.summary-card .lbl { color: #94a3b8; font-size: 0.75rem; margin-top: 0.25rem; }
.agent-grid { display: grid; gap: 1.5rem; }
.agent-card { background: #1e293b; border: 1px solid #334155; border-radius: 0.5rem; overflow: hidden; }
.agent-card:hover { border-color: #475569; }
.agent-header { display: flex; align-items: center; gap: 1rem; padding: 1.25rem; background: #0f172a; border-bottom: 1px solid #334155; }
.agent-icon { font-size: 2.5rem; }
.agent-title { flex: 1; }
.agent-name { font-size: 1.25rem; font-weight: 600; margin-bottom: 0.25rem; }
.agent-server { font-size: 0.8rem; color: #64748b; }
.mode-badge { padding: 0.4rem 0.75rem; border-radius: 0.375rem; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; }
.mode-live { background: #166534; color: #86efac; }
.mode-mock { background: #854d0e; color: #fcd34d; }
.mode-active { background: #1e40af; color: #93c5fd; }
.agent-body { padding: 1.25rem; }
.agent-desc { color: #94a3b8; font-size: 0.9rem; line-height: 1.5; margin-bottom: 1rem; }
.agent-section { margin-bottom: 1rem; }
.agent-section-title { font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 500; margin-bottom: 0.5rem; }
.agent-meta { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.agent-meta-item { background: #0f172a; padding: 0.4rem 0.75rem; border-radius: 0.25rem; font-size: 0.8rem; }
.agent-meta-item .label { color: #64748b; }
.agent-meta-item .value { color: #e2e8f0; }
.channel-badge { background: #312e81; color: #a5b4fc; padding: 0.3rem 0.6rem; border-radius: 0.25rem; font-size: 0.75rem; }
.capability-list { list-style: none; }
.capability-list li { padding: 0.25rem 0; font-size: 0.85rem; color: #94a3b8; }
.capability-list li::before { content: 'âœ“ '; color: #4ade80; }
.guardrail-list { list-style: none; }
.guardrail-list li { padding: 0.25rem 0; font-size: 0.85rem; color: #fbbf24; }
.guardrail-list li::before { content: 'âš  '; }
@media (max-width: 768px) { .page-container { padding: 1rem; } }
    </style>
</head>
<body>
    <nav class="main-nav">
        <a href="/" class="logo">Homebase</a>
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/servers">Servers</a>
            <a href="/projects">Projects</a>
            <a href="/project-status">Status</a>
            <a href="/agents">Agents</a>
            <a href="/static/mindmap.html">ðŸ§  Mind Map</a>
            <a href="/sentinel">Sentinel</a>
            <a href="/metrics">Metrics</a>
            <a href="/security">Security</a>
            <a href="/research">Research</a>
            <a href="/infrastructure">Infrastructure</a>
            <a href="/audit-tracker">Audit</a>
        </div>
    </nav>

    <div class="page-container">
        <div class="page-header">
            <h1>AI Agents</h1>
            <p>Autonomous agents with guardrails and monitoring</p>
        </div>

        <div class="summary-cards">
            <div class="summary-card"><div class="num green" id="live-count">-</div><div class="lbl">Live</div></div>
            <div class="summary-card"><div class="num yellow" id="mock-count">-</div><div class="lbl">Mock</div></div>
            <div class="summary-card"><div class="num blue" id="active-count">-</div><div class="lbl">Active</div></div>
            <div class="summary-card"><div class="num" id="total-count">-</div><div class="lbl">Total</div></div>
        </div>

        <div class="agent-grid" id="agent-grid">Loading...</div>
    </div>

    <script>
    const agentDetails = {
        'David Bishop': {
            description: 'AI business development agent. Handles customer communications, proposal drafting, pricing analysis, and deal tracking. Primary interface for sales automation and client relationship management.',
            capabilities: [
                'Draft proposals and quotes',
                'Analyze pricing and margins',
                'Track deals in pipeline',
                'Research companies and contacts',
                'Route emails to appropriate team members',
                'Schedule follow-ups and reminders'
            ],
            guardrails: [
                'No direct customer contact without CEO approval',
                'Cannot offer discounts or modify pricing',
                'Pricing deviations >20% require CEO sign-off',
                'Cannot access financial systems directly',
                'All outbound emails require human review'
            ]
        },
        'Sentinel': {
            description: 'Guardrails and security monitoring system. Monitors all other agents heartbeats, enforces guardrails, runs security scans, and manages kill switches. The watchdog that watches the watchdogs.',
            capabilities: [
                'Monitor agent heartbeats',
                'Enforce guardrail compliance',
                'Run security vulnerability scans',
                'Manage agent kill switches',
                'Audit agent actions and outputs',
                'Alert on anomalous behavior'
            ],
            guardrails: [
                'Cannot modify own guardrails',
                'Cannot deploy new agent code',
                'Kill switch requires confirmation',
                'Cannot access agent credentials',
                'All security alerts logged immutably'
            ]
        }
    };

    async function loadAgents() {
        try {
            const res = await fetch('/api/infrastructure');
            const infra = await res.json();
            const agents = infra.agents || [];
            const servers = {};
            (infra.servers || []).forEach(s => servers[s.id] = s);
            
            const live = agents.filter(a => a.mode === 'live').length;
            const mock = agents.filter(a => a.mode === 'mock').length;
            const active = agents.filter(a => a.mode === 'active').length;
            
            document.getElementById('live-count').textContent = live;
            document.getElementById('mock-count').textContent = mock;
            document.getElementById('active-count').textContent = active;
            document.getElementById('total-count').textContent = agents.length;
            
            document.getElementById('agent-grid').innerHTML = agents.map(a => {
                const server = servers[a.server] || {};
                const modeClass = 'mode-' + (a.mode || 'mock');
                const details = agentDetails[a.name] || {description: a.description || '', capabilities: [], guardrails: []};
                
                return '<div class="agent-card">' +
                    '<div class="agent-header">' +
                    '<span class="agent-icon">ðŸ¤–</span>' +
                    '<div class="agent-title">' +
                    '<div class="agent-name">' + a.name + '</div>' +
                    '<div class="agent-server">' + (server.hostname || a.server) + ' (' + (server.ip || '?') + ')</div>' +
                    '</div>' +
                    '<span class="mode-badge ' + modeClass + '">' + (a.mode || 'mock') + '</span>' +
                    '</div>' +
                    '<div class="agent-body">' +
                    '<div class="agent-desc">' + details.description + '</div>' +
                    '<div class="agent-section">' +
                    '<div class="agent-section-title">Communication</div>' +
                    '<div class="agent-meta">' +
                    (a.channels || []).map(c => '<span class="channel-badge">' + c + '</span>').join('') +
                    '</div></div>' +
                    '<div class="agent-section">' +
                    '<div class="agent-section-title">Ports</div>' +
                    '<div class="agent-meta">' +
                    (a.ports || []).map(p => '<span class="agent-meta-item">' + p + '</span>').join('') +
                    '</div></div>' +
                    (details.capabilities.length > 0 ? '<div class="agent-section"><div class="agent-section-title">Capabilities</div><ul class="capability-list">' + details.capabilities.map(c => '<li>' + c + '</li>').join('') + '</ul></div>' : '') +
                    (details.guardrails.length > 0 ? '<div class="agent-section"><div class="agent-section-title">Guardrails</div><ul class="guardrail-list">' + details.guardrails.map(g => '<li>' + g + '</li>').join('') + '</ul></div>' : '') +
                    '</div></div>';
            }).join('');
        } catch (e) {
            document.getElementById('agent-grid').innerHTML = '<div style="color:#f87171">Failed to load</div>';
        }
    }
    
    loadAgents();
    </script>
</body>
</html>